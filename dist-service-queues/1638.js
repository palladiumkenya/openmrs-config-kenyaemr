"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[1638,3728],{3728:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(1343),u=n.n(r),i=n(72339),o=n(91848),a=n(97355),l=n(54932);function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const d=function(e){var t=e.queueEntry,n=e.closeModal,r=(0,i.useTranslation)().t;return u().createElement(o.A,{queueEntry:t,closeModal:n,modalParams:{modalTitle:r("movePatient","Move {{patient}}",{patient:t.display}),submitButtonText:r("move","Move"),submitSuccessTitle:r("queueEntryTransitioned","Queue entry transitioned"),submitSuccessText:r("queueEntryTransitionedSuccessfully","Queue entry transitioned successfully"),submitFailureTitle:r("queueEntryTransitionFailed","Error transitioning queue entry"),submitAction:function(e,t){var n,r,u=new Date(t.transitionDate),i=(n=(0,l.R)(t.transitionTime,t.transitionTimeFormat),r=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,u,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){a=!0,u=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw u}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],d=i[1];return u.setHours(o,d,0,0),(0,a.TI)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){s(e,t,n[t])})}return e}({queueEntryToTransition:e.uuid,newQueue:t.selectedQueue,newStatus:t.selectedStatus,newPriority:t.selectedPriority,newPriorityComment:t.prioritycomment},t.modifyDefaultTransitionDateTime?{transitionDate:u.toISOString()}:{}))},disableSubmit:function(e,t){return t.selectedQueue==e.queue.uuid&&t.selectedStatus==e.status.uuid},isEdit:!1,showQueuePicker:!0,showStatusPicker:!1}})}},21364:(e,t,n)=>{n.d(t,{A:()=>k});var r=n(1343),u=n.n(r),i=n(15680),o=n(80824),a=n(72339),l=n(68580),c=n(81160),s=n(54440);function d(e,t,n,r,u,i,o){try{var a=e[i](o),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,u)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(r,u){var i=e.apply(t,n);function o(e){d(i,r,u,o,a,"next",e)}function a(e){d(i,r,u,o,a,"throw",e)}o(void 0)})}}function v(e,t){var n,r,u,i={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(u=2&a[0]?r.return:a[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,a[1])).done)return u;switch(r=0,u&&(a=[2&a[0],u.value]),a[0]){case 0:case 1:u=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((u=(u=i.trys).length>0&&u[u.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!u||a[1]>u[0]&&a[1]<u[3])){i.label=a[1];break}if(6===a[0]&&i.label<u[1]){i.label=u[1],u=a;break}if(u&&i.label<u[2]){i.label=u[2],i.ops.push(a);break}u[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=u=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function m(e,t,n,r){return f(function(){var u;return v(this,function(i){switch(i.label){case 0:return u=new AbortController,[4,(0,s.openmrsFetch)("".concat(s.restBaseUrl,"/queue-entry-number?location=").concat(e,"&queue=").concat(n,"&visit=").concat(t,"&visitAttributeType=").concat(r),{method:"GET",headers:{"Content-Type":"application/json"},signal:u.signal})];case 1:return i.sent(),[2]}})})()}function y(e,t,n,r,u,i,o,a){return f(function(){var l;return v(this,function(c){switch(c.label){case 0:return l=new AbortController,[4,Promise.all([m(o,e,t,a)])];case 1:return c.sent(),[2,(0,s.openmrsFetch)("".concat(s.restBaseUrl,"/visit-queue-entry"),{method:"POST",headers:{"Content-Type":"application/json"},signal:l.signal,body:{visit:{uuid:e},queueEntry:{status:{uuid:u},priority:{uuid:r},queue:{uuid:t},patient:{uuid:n},startedAt:new Date,sortWeight:i}}})]}})})()}var p=n(51751),b=n(66985),h=n(50942),g=n(57691),S=n(26861);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q(e,t,n,r,u,i,o){try{var a=e[i](o),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,u)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){E(e,t,n[t])})}return e}function P(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t.push.apply(t,n)}return t}(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}const k=u().memo(function(e){var t=e.setOnSubmit,n=e.defaultInitialServiceQueue,d=(0,a.useTranslation)().t,f=(0,r.useMemo)(function(){return l.Ik({queueLocation:l.Yj().trim(),queueService:l.Yj().trim(),priority:l.Yj().trim().optional().or(l.eu(""))})},[d]),v=(0,s.useSession)().sessionLocation,m=(0,b.l)(),E=m.queueLocations,k=m.isLoading,L=(0,r.useMemo)(function(){return E.map(function(e){return{id:e.id,name:e.name}})},[E]),O=(0,s.useConfig)(),j=O.concepts,A=j.defaultStatusConceptUuid,C=(j.defaultPriorityConceptUuid,j.emergencyPriorityConceptUuid),Q=O.visitQueueNumberAttributeUuid,x=(0,S.cv)().selectedServiceUuid,I=(0,p.fe)().mutateQueueEntries,U=(0,o.mN)({defaultValues:{priority:"",queueLocation:"",queueService:""},mode:"onChange",resolver:(0,c.u)(f)}),F=U.control,D=U.formState,V=D.errors,M=D.touchedFields,_=D.isSubmitted,B=U.setValue,N=U.trigger,W=U.watch,R=U.getValues,Y=U.clearErrors,$=W("queueLocation"),G=W("queueService"),z=W("priority"),H=(0,h.A)($),J=H.queues,K=H.isLoading,X=(0,r.useMemo)(function(){return J.map(function(e){return{uuid:e.uuid,name:e.name,allowedPriorities:e.allowedPriorities}})},[J]),Z=(0,r.useMemo)(function(){var e,t;return null!==(t=null===(e=X.find(function(e){return e.uuid===G}))||void 0===e?void 0:e.allowedPriorities)&&void 0!==t?t:[]},[X,G]),ee=z===C?1:0,te=!k&&!K,ne=$&&G,re=(0,r.useCallback)(function(e){return(t=function(){var t,n,r,u,i,o;return function(e,t){var n,r,u,i={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(i=0)),i;)try{if(n=1,r&&(u=2&a[0]?r.return:a[0]?r.throw||((u=r.return)&&u.call(r),0):r.next)&&!(u=u.call(r,a[1])).done)return u;switch(r=0,u&&(a=[2&a[0],u.value]),a[0]){case 0:case 1:u=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((u=(u=i.trys).length>0&&u[u.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!u||a[1]>u[0]&&a[1]<u[3])){i.label=a[1];break}if(6===a[0]&&i.label<u[1]){i.label=u[1],u=a;break}if(u&&i.label<u[2]){i.label=u[2],i.ops.push(a);break}u[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=u=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),ne?[3,2]:$?[4,N(["queueLocation","queueService","priority"])]:[2,Promise.resolve()];case 1:if(!a.sent())throw t=Object.entries(V).map(function(e){var t,n,r,u=(r=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,u,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){a=!0,u=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw u}}return i}}(n,r)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=u[0],o=u[1];return"".concat(i,": ").concat(null!==(t=null==o?void 0:o.message)&&void 0!==t?t:"Invalid")}).join("\n"),(0,s.showSnackbar)({title:d("formValidationFailed","Form validation failed"),kind:"error",isLowContrast:!1,subtitle:t}),new Error("Form validation failed:\n".concat(t));a.label=2;case 2:if(n=R(),$&&!n.queueService)throw r=[d("service","Service")],u=d("missingRequiredFields","Missing required fields: {{fields}}",{fields:r.join(", ")}),(0,s.showSnackbar)({title:d("incompleteForm","Incomplete form"),kind:"error",isLowContrast:!1,subtitle:u}),new Error(u);return n.queueLocation&&n.queueService?[2,y(e.uuid,n.queueService,e.patient.uuid,n.priority||"",A,ee,n.queueLocation,Q).then(function(){(0,s.showSnackbar)({kind:"success",isLowContrast:!0,title:d("addedPatientToQueue","Added patient to queue"),subtitle:d("queueEntryAddedSuccessfully","Queue entry added successfully")}),I()}).catch(function(e){var t,n,r;throw((null==e||null===(n=e.responseBody)||void 0===n||null===(t=n.error)||void 0===t?void 0:t.message)||(null==e?void 0:e.message)||"").includes(g.m6)?(0,s.showSnackbar)({title:d("patientAlreadyInQueue","Patient already in queue"),kind:"warning",isLowContrast:!1,subtitle:d("duplicateQueueEntry","This patient is already in the selected queue.")}):(0,s.showSnackbar)({title:d("queueEntryError","Error adding patient to the queue"),kind:"error",isLowContrast:!1,subtitle:null!==(r=null==e?void 0:e.message)&&void 0!==r?r:d("unknownError","An unknown error occurred")}),e})]:[2,Promise.resolve()];case 3:throw i=a.sent(),(0,s.showSnackbar)({title:d("unexpectedError","Unexpected error"),kind:"error",isLowContrast:!1,subtitle:null!==(o=null==i?void 0:i.message)&&void 0!==o?o:d("unknownError","An unknown error occurred")}),i;case 4:return[2]}})},function(){var e=this,n=arguments;return new Promise(function(r,u){var i=t.apply(e,n);function o(e){q(i,r,u,o,a,"next",e)}function a(e){q(i,r,u,o,a,"throw",e)}o(void 0)})})();var t},[A,I,ee,d,N,Q,V,R,ne,$]);return(0,r.useEffect)(function(){null==t||t(re)},[re,t]),(0,r.useEffect)(function(){var e=R("queueLocation");(null==v?void 0:v.uuid)&&!e&&!M.queueLocation&&L.length>0&&L.some(function(e){return e.id===v.uuid})&&B("queueLocation",v.uuid,{shouldValidate:te})},[v,L,R,M.queueLocation,B,te]),(0,r.useEffect)(function(){var e=R("queueService");!x||e||M.queueService||B("queueService",x,{shouldValidate:te})},[x,R,M.queueService,B,te]),(0,r.useEffect)(function(){if(n&&X.length>0&&!G&&$){var e=X.find(function(e){return e.name===n});e&&G!==e.uuid&&B("queueService",e.uuid,{shouldValidate:te})}},[n,X,G,B,te,$]),(0,r.useEffect)(function(){$&&G&&(X.some(function(e){return e.uuid===G})||(B("queueService","",{shouldValidate:te}),B("priority","",{shouldValidate:te})))},[$,X,G,B,te]),(0,r.useEffect)(function(){G&&0!==Z.length||(B("priority","",{shouldValidate:!1}),Y("priority"))},[G,Z,B,Y]),(0,r.useEffect)(function(){$||(B("queueService","",{shouldValidate:!1}),B("priority","",{shouldValidate:!1}),Y(["queueService","priority"]))},[$,B,Y]),u().createElement(i.BJc,{gap:5},u().createElement(s.ResponsiveWrapper,null,u().createElement(i.gE_,{legendText:d("queueLocation","Queue Location")},u().createElement(o.xI,{name:"queueLocation",control:F,render:function(e){var t,n=e.field;return k?u().createElement(i.aB4,null):u().createElement(i.l6P,P(T({},n),{labelText:"",id:"queueLocation",invalid:!!V.queueLocation&&(M.queueLocation||_),invalidText:null===(t=V.queueLocation)||void 0===t?void 0:t.message,onChange:function(e){n.onChange(e.target.value),e.target.value!==$&&(B("queueService","",{shouldValidate:!1}),B("priority","",{shouldValidate:!1}),Y(["queueService","priority"]))}}),u().createElement(i.ebT,{text:d("selectQueueLocation","Select a queue location"),value:""}),null==L?void 0:L.map(function(e){return u().createElement(i.ebT,{key:e.id,text:e.name,value:e.id},e.name)}))}}))),$&&u().createElement(i.gE_,{legendText:d("service","Service")},u().createElement(o.xI,{name:"queueService",control:F,render:function(e){var t,n=e.field;return K?u().createElement(i.aB4,null):(null==X?void 0:X.length)?u().createElement(i.l6P,P(T({},n),{labelText:"",id:"queueService",invalid:!!V.queueService&&(M.queueService||_),invalidText:null===(t=V.queueService)||void 0===t?void 0:t.message,onChange:function(e){n.onChange(e.target.value),e.target.value!==G&&(B("priority","",{shouldValidate:!1}),Y("priority"))}}),u().createElement(i.ebT,{text:d("selectQueueService","Select a queue service"),value:""}),null==X?void 0:X.map(function(e){return u().createElement(i.ebT,{key:e.uuid,text:e.name,value:e.uuid},e.name)})):u().createElement(i.jeF,{kind:"error",lowContrast:!0,subtitle:d("configureServices","Please configure services to continue."),title:d("noServicesConfigured","No services configured")})}})),$&&G&&u().createElement(i.gE_,{legendText:d("priority","Priority")},u().createElement(o.xI,{name:"priority",control:F,render:function(e){var t=e.field;return K?u().createElement(i.zWQ,null,u().createElement(i.Psq,null),u().createElement(i.Psq,null),u().createElement(i.Psq,null)):(null==Z?void 0:Z.length)?u().createElement(i.zWQ,P(T({},t),{id:"priority",valueSelected:t.value,onChange:function(e){return t.onChange(e)}}),Z.map(function(e){var t=e.uuid,n=e.display;return u().createElement(i.aaP,{key:t,labelText:n,value:t})})):u().createElement(i.jeF,{kind:"error",lowContrast:!0,title:d("noPrioritiesForServiceTitle","No priorities available")},d("noPrioritiesForService","The selected service does not have any allowed priorities. This is an error in configuration. Please contact your system administrator."))}})))})},26861:(e,t,n)=>{n.d(t,{E9:()=>c,YR:()=>l,cv:()=>f,i6:()=>s,yn:()=>d});var r=n(54440);function u(e,t){null==t?sessionStorage.removeItem(e):sessionStorage.setItem(e,t)}function i(e){return sessionStorage.getItem(e)}var o={selectedQueueLocationName:i("queueLocationName"),selectedQueueLocationUuid:i("queueLocationUuid"),selectedServiceUuid:i("queueServiceUuid"),selectedServiceDisplay:i("queueServiceDisplay"),selectedQueueStatusUuid:i("queueStatusUuid"),selectedQueueStatusDisplay:i("queueStatusDisplay")},a=(0,r.createGlobalStore)("serviceQueues",o),l=function(e,t){u("queueServiceUuid",e),u("queueServiceDisplay",t),a.setState({selectedServiceUuid:e,selectedServiceDisplay:t})},c=function(e){u("queueLocationName",e),a.setState({selectedQueueLocationName:e})},s=function(e){u("queueLocationUuid",e),a.setState({selectedQueueLocationUuid:e})},d=function(e,t){u("queueStatusUuid",e),u("queueStatusDisplay",t),a.setState({selectedQueueStatusUuid:e,selectedQueueStatusDisplay:t})};function f(){return(0,r.useStore)(a)}},66985:(e,t,n)=>{n.d(t,{l:()=>i});var r=n(1343),u=n(54440);function i(){var e="".concat(u.fhirBaseUrl,"/Location?_summary=data&_tag=queue location"),t=(0,u.useFhirFetchAll)(e),n=t.data,i=t.error,o=t.isLoading;return{queueLocations:(0,r.useMemo)(function(){var e;return null!==(e=null==n?void 0:n.map(function(e){return e}).sort(function(e,t){return e.name.localeCompare(t.name,(0,u.getLocale)())}))&&void 0!==e?e:[]},[n]),isLoading:o,error:i}}},71638:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(1343),u=n.n(r),i=n(15680),o=n(72339),a=n(71123),l=n(54440),c=n(51751),s=n(21364);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,u,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){a=!0,u=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw u}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const v=function(e){var t=e.modalTitle,n=e.activeVisit,a=e.closeModal,d=(0,o.useTranslation)().t,v=(0,c.fe)().mutateQueueEntries,m=(0,l.useConfig)(),y=f((0,r.useState)(!1),2),p=y[0],b=y[1],h=f((0,r.useState)(null),2),g=h[0],S=h[1],w=(0,r.useCallback)(function(e){var t,r,u,i;e.preventDefault(),b(!0),null==g||null===(i=g.submitQueueEntry)||void 0===i||null===(u=i.call(g,n))||void 0===u||null===(r=u.then(function(){a(),v()}))||void 0===r||null===(t=r.catch(function(e){(0,l.showSnackbar)({title:d("queueEntryError","Error adding patient to the queue"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message})}))||void 0===t||t.finally(function(){b(!1)})},[g,n,a,v,d]);return u().createElement(i.lVW,{onSubmit:w},u().createElement(i.rQ0,{closeModal:a,title:t}),u().createElement(i.cwr,null,u().createElement(s.A,{setOnSubmit:function(e){return S({submitQueueEntry:e})},defaultInitialServiceQueue:m.defaultInitialServiceQueue})),u().createElement(i.jlY,null,u().createElement(i.$nd,{kind:"secondary",onClick:a},d("cancel","Cancel")),u().createElement(i.$nd,{disabled:p,kind:"primary",type:"submit"},p?d("addingPatientToQueue","Adding patient to queue")+"...":d("addPatientToQueue","Add patient to queue"))))};var m=n(3728);const y=function(e){var t,n=e.closeModal,r=e.activeVisit,c=null==r||null===(t=r.patient)||void 0===t?void 0:t.uuid,s=(0,o.useTranslation)().t,d=function(e){var t,n,r=encodeURIComponent("custom:(uuid,display,queue:(uuid,display,name,location:(uuid,display),service:(uuid,display),allowedPriorities:(uuid,display),allowedStatuses:(uuid,display)),status,patient:(uuid,display),visit:(uuid,display,startDatetime),priority,priorityComment,sortWeight,startedAt,endedAt,locationWaitingFor,queueComingFrom,providerWaitingFor,previousQueueEntry)"),u="".concat(l.restBaseUrl,"/queue-entry?v=").concat(r,"&patient=").concat(e,"&isEnded=false"),i=(0,a.Ay)(u,l.openmrsFetch),o=i.data,c=i.error,s=i.isLoading,d=i.mutate;return{data:(null==o||null===(n=o.data)||void 0===n||null===(t=n.results)||void 0===t?void 0:t.reduce(function(e,t){return!e||new Date(t.startedAt)>new Date(e.startedAt)?t:e},null))||null,error:c,isLoading:s,mutate:d}}(c),f=d.data,y=d.isLoading,p=d.error;return y?u().createElement(i.dF7,null):p?u().createElement(i.jeF,{kind:"error",title:s("errorLoadingQueueEntry","Error loading queue entry"),subtitle:(null==p?void 0:p.message)||s("unexpectedError","An unexpected error occurred"),lowContrast:!0}):u().createElement(u().Fragment,null,f?u().createElement(m.default,{queueEntry:f,closeModal:n}):u().createElement(v,{modalTitle:s("addPatientToQueue","Add patient to queue"),activeVisit:r,closeModal:n}))}}}]);