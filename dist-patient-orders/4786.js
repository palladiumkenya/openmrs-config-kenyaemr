"use strict";(globalThis.webpackChunk_openmrs_esm_patient_orders_app=globalThis.webpackChunk_openmrs_esm_patient_orders_app||[]).push([[4786],{6174:(e,n,t)=>{t.d(n,{A:()=>l});var r=t(977),a=t.n(r),o=t(5924),i=t.n(o)()(a());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--bottom-nav-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.-esm-patient-orders__lab-results-form__heading___fTKub{margin-bottom:1rem}.-esm-patient-orders__lab-results-form__loaderContainer___U\\+oN\\+{display:flex;justify-content:center;align-items:center;height:100%}.-esm-patient-orders__lab-results-form__loader___4SdWS{height:100%;justify-content:center;align-items:center}.-esm-patient-orders__lab-results-form__sectionTitle___Yxa21{margin-bottom:.75rem}.-esm-patient-orders__lab-results-form__modalBody___-xpgg{padding-bottom:1rem}.-esm-patient-orders__lab-results-form__textInput___Pl9Tk{margin:.25rem 0 1rem}.-esm-patient-orders__lab-results-form__errorDiv___cihR1{color:#da1e28}.-esm-patient-orders__lab-results-form__button___95KrO{height:4rem;display:flex;align-content:flex-start;align-items:baseline;min-width:50%}.-esm-patient-orders__lab-results-form__button___95KrO .cds--inline-loading{min-height:1rem !important}.-esm-patient-orders__lab-results-form__button___95KrO .cds--inline-loading__text{font-size:unset !important}.-esm-patient-orders__lab-results-form__tablet___LLfFY{padding:1.5rem 1rem;background-color:#fff}.-esm-patient-orders__lab-results-form__desktop___pvHvx{padding:0}.-esm-patient-orders__lab-results-form__form___6Ln0z{display:flex;flex-direction:column;justify-content:space-between;height:100%}.omrs-breakpoint-lt-desktop .-esm-patient-orders__lab-results-form__form___6Ln0z{background-color:#ededed}.omrs-breakpoint-gt-tablet .-esm-patient-orders__lab-results-form__form___6Ln0z{background-color:#fff}.-esm-patient-orders__lab-results-form__grid___OK2fB{margin:1rem}.-esm-patient-orders__lab-results-form__row___jNFFF{margin:.5rem 0 0;display:flex;flex-flow:row wrap;gap:1rem}.-esm-patient-orders__lab-results-form__spacer___oWMw9{margin-top:1rem}.-esm-patient-orders__lab-results-form__emptyFormError___zemKE{margin:.625rem 0}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/lab-results/lab-results-form.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAsDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,oGAAA,CACA,2GAAA,CCzDF,wDACE,kBC0BW,CDvBb,kEACE,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,WAAA,CAGF,uDACE,WAAA,CACA,sBAAA,CACA,kBAAA,CAGF,6DACE,oBCIW,CDDb,0DACE,mBCKW,CDFb,0DACE,oBAAA,CAGF,yDACE,aDZO,CCeT,uDACE,WCkBW,CDjBX,YAAA,CACA,wBAAA,CACA,oBAAA,CACA,aAAA,CAEA,4EACE,0BAAA,CAGF,kFACE,0BAAA,CAIJ,uDACE,mBAAA,CACA,qBDpDM,CCuDR,wDACE,SAAA,CAGF,qDACE,YAAA,CACA,qBAAA,CACA,6BAAA,CACA,WAAA,CAGF,iFACE,wBAAA,CAGF,gFACE,qBDvEM,CC0ER,qDACE,WC/CW,CDkDb,oDACE,gBAAA,CACA,YAAA,CACA,kBAAA,CACA,QCtDW,CDyDb,uDACE,eC1DW,CD6Db,+DACE,gBAAA",sourcesContent:["@use '@carbon/layout';\n\n$ui-01: #f4f4f4;\n$ui-02: #ffffff;\n$ui-03: #e0e0e0;\n$ui-04: #8d8d8d;\n$ui-05: #161616;\n$text-02: #525252;\n$text-03: #a8a8a8;\n$ui-background: #ffffff;\n$color-gray-30: #c6c6c6;\n$color-gray-70: #525252;\n$color-gray-100: #161616;\n$color-blue-60-2: #0f62fe;\n$color-blue-10: #edf5ff;\n$color-yellow-50: #feecae;\n$carbon--red-50: #fa4d56;\n$inverse-link: #78a9ff;\n$support-02: #24a148;\n$inverse-support-03: #f1c21b;\n$warning-background: #fff8e1;\n$openmrs-background-grey: #f4f4f4;\n$danger: #da1e28;\n$interactive-01: #0f62fe;\n$field-01: #f4f4f4;\n$grey-2: #e0e0e0;\n$labeldropdown: #c6c6c6;\n\n$brand-primary-10: #d9fbfb;\n$brand-primary-20: #9ef0f0;\n$brand-primary-30: #3ddbd9;\n$brand-primary-40: #08bdba;\n$brand-primary-50: #009d9a;\n\n/* 60,70 and 80 are already declared as brand-01, 02 and 03 respectively */\n\n$brand-primary-90: #022b30;\n$brand-primary-100: #081a1c;\n\n@mixin brand-01($property) {\n  #{$property}: #005d5d;\n  #{$property}: var(--brand-01);\n}\n\n@mixin brand-02($property) {\n  #{$property}: #004144;\n  #{$property}: var(--brand-02);\n}\n\n@mixin brand-03($property) {\n  #{$property}: #007d79;\n  #{$property}: var(--brand-03);\n}\n\n:root {\n  --brand-01: #005d5d;\n  --brand-02: #004144;\n  --brand-03: #007d79;\n  --bottom-nav-height: #{layout.$spacing-10};\n  --workspace-header-height: #{layout.$spacing-09};\n  --tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--bottom-nav-height));\n  --desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height));\n}\n\n$breakpoint-phone-min: 0px;\n$breakpoint-phone-max: 600px;\n$breakpoint-tablet-min: 601px;\n$breakpoint-tablet-max: 1023px;\n$breakpoint-small-desktop-min: 1024px;\n$breakpoint-small-desktop-max: 1439px;\n$breakpoint-large-desktop-min: 1440px;\n$breakpoint-large-desktop-max: 99999999px;\n\n/* These color variables will be removed in a future release */\n$brand-teal-01: #007d79;\n$brand-01: #005d5d;\n$brand-02: #004144;\n","@use '@carbon/layout';\n@use '@carbon/type';\n@use '@openmrs/esm-styleguide/src/vars' as *;\n\n.heading {\n  margin-bottom: layout.$spacing-05;\n}\n\n.loaderContainer {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n\n.loader {\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n}\n\n.sectionTitle {\n  margin-bottom: layout.$spacing-04;\n}\n\n.modalBody {\n  padding-bottom: layout.$spacing-05;\n}\n\n.textInput {\n  margin: layout.$spacing-02 0 layout.$spacing-05;\n}\n\n.errorDiv {\n  color: $danger;\n}\n\n.button {\n  height: layout.$spacing-10;\n  display: flex;\n  align-content: flex-start;\n  align-items: baseline;\n  min-width: 50%;\n\n  :global(.cds--inline-loading) {\n    min-height: layout.$spacing-05 !important;\n  }\n\n  :global(.cds--inline-loading__text) {\n    font-size: unset !important;\n  }\n}\n\n.tablet {\n  padding: layout.$spacing-06 layout.$spacing-05;\n  background-color: $ui-02;\n}\n\n.desktop {\n  padding: 0;\n}\n\n.form {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n}\n\n:global(.omrs-breakpoint-lt-desktop) .form {\n  background-color: #ededed;\n}\n\n:global(.omrs-breakpoint-gt-tablet) .form {\n  background-color: $ui-02;\n}\n\n.grid {\n  margin: layout.$spacing-05;\n}\n\n.row {\n  margin: layout.$spacing-03 0 0;\n  display: flex;\n  flex-flow: row wrap;\n  gap: layout.$spacing-05;\n}\n\n.spacer {\n  margin-top: layout.$spacing-05;\n}\n\n.emptyFormError {\n  margin: 0.625rem 0;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),i.locals={heading:"-esm-patient-orders__lab-results-form__heading___fTKub",loaderContainer:"-esm-patient-orders__lab-results-form__loaderContainer___U+oN+",loader:"-esm-patient-orders__lab-results-form__loader___4SdWS",sectionTitle:"-esm-patient-orders__lab-results-form__sectionTitle___Yxa21",modalBody:"-esm-patient-orders__lab-results-form__modalBody___-xpgg",textInput:"-esm-patient-orders__lab-results-form__textInput___Pl9Tk",errorDiv:"-esm-patient-orders__lab-results-form__errorDiv___cihR1",button:"-esm-patient-orders__lab-results-form__button___95KrO",tablet:"-esm-patient-orders__lab-results-form__tablet___LLfFY",desktop:"-esm-patient-orders__lab-results-form__desktop___pvHvx",form:"-esm-patient-orders__lab-results-form__form___6Ln0z",grid:"-esm-patient-orders__lab-results-form__grid___OK2fB",row:"-esm-patient-orders__lab-results-form__row___jNFFF",spacer:"-esm-patient-orders__lab-results-form__spacer___oWMw9",emptyFormError:"-esm-patient-orders__lab-results-form__emptyFormError___zemKE"};const l=i},4786:(e,n,t)=>{t.r(n),t.d(n,{default:()=>z});var r=t(1343),a=t.n(r),o=t(7729),i=t(3373),l=t.n(i),u=t(824),s=t(3150),c=t(1123),d=t(1160),p=t(8254),m=t(1347),b=t(6195),f=function(e){var n=e.hiAbsolute,t=e.lowAbsolute;switch(e.datatype.hl7Abbreviation){case"ST":return b.z.string().optional();case"NM":return _(e,n,t);default:return b.z.any()}},_=function(e,n,t){var r=e.allowDecimal,a=e.display,o=b.z.preprocess((function(e){if(""!==e&&null!=e){var n=Number(e);if(!isNaN(n))return n}}),b.z.number().optional()).refine((function(e){return void 0===e||!isNaN(e)}),{message:"".concat(a," must be a valid number")}).refine((function(e){return void 0===e||!!r||Number.isInteger(e)}),{message:"".concat(a,r?" must be a valid number":" must be a whole number")}),i=null!=t,l=null!=n;return i||l?i&&l?o.refine((function(e){return void 0===e||e>=t&&e<=n}),{message:"".concat(a," must be between ").concat(t," and ").concat(n)}):i?o.refine((function(e){return void 0===e||e>=t}),{message:"".concat(a," must be greater than or equal to ").concat(t)}):l?o.refine((function(e){return void 0===e||e<=n}),{message:"".concat(a," must be less than or equal to ").concat(n)}):void 0:o},g=t(506),y=t.n(g),v=t(9867),A=t.n(v),h=t(105),C=t.n(h),$=t(7154),k=t.n($),w=t(5326),E=t.n(w),x=t(7763),D=t.n(x),N=t(6174),O={};O.styleTagTransform=D(),O.setAttributes=k(),O.insert=C().bind(null,"head"),O.domAPI=A(),O.insertStyleElement=E(),y()(N.A,O);const T=N.A&&N.A.locals?N.A.locals:void 0;function S(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){S(e,n,t[n])}))}return e}function B(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n.push.apply(n,t)}return n}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}const F=function(e){var n=e.concept,t=e.control,r=e.defaultValue,i=e.errors,l=(0,s.useTranslation)().t,c=function(e){var n;if("NM"!==(null==e||null===(n=e.datatype)||void 0===n?void 0:n.hl7Abbreviation))return"";var t=e.hiAbsolute,r=e.lowAbsolute,a=e.units,o=a?" ".concat(a):"",i=null!=r,l=null!=t;return i&&l?" (".concat(r," - ").concat(t," ").concat(o,")"):l?" (<= ".concat(t," ").concat(o,")"):i?" (>= ".concat(r," ").concat(o,")"):a?" (".concat(o,")"):""},d=function(e,n){var t,a,o=null==r||null===(a=r.groupMembers)||void 0===a||null===(t=a.find((function(n){return n.concept.uuid===e})))||void 0===t?void 0:t.value;return"CWE"===n&&o&&"object"==typeof o&&"uuid"in o?o.uuid:o};return a().createElement(a().Fragment,null,(0,m.KH)(n)&&a().createElement(u.xI,{control:t,name:n.uuid,render:function(e){var t,r=e.field;return a().createElement(o.ksK,B(j({},r),{className:T.textInput,id:n.uuid,key:n.uuid,labelText:"".concat((null==n?void 0:n.display)?n.display+" ":"").concat(c(n)),type:"text",invalidText:null===(t=i[n.uuid])||void 0===t?void 0:t.message,invalid:!!i[n.uuid]}))}}),(0,m.kf)(n)&&a().createElement(u.xI,{control:t,name:n.uuid,render:function(e){var t,r=e.field;return a().createElement(o.Q7x,{allowEmpty:!0,className:T.numberInput,disableWheel:!0,hideSteppers:!0,id:n.uuid,key:n.uuid,label:"".concat((null==n?void 0:n.display)?n.display+" ":"").concat(c(n)),onChange:function(e){return r.onChange(parseFloat(e.target.value))},value:r.value||"",invalidText:null===(t=i[n.uuid])||void 0===t?void 0:t.message,invalid:!!i[n.uuid]})}}),(0,m.eY)(n)&&a().createElement(u.xI,{name:n.uuid,control:t,render:function(e){var t,r,u,s=e.field;return a().createElement(o.l6P,B(j({},s),{className:T.textInput,defaultValue:d(n.uuid,n.datatype.hl7Abbreviation),id:"select-".concat(n.uuid),key:n.uuid,labelText:"".concat((null==n?void 0:n.display)?n.display+" ":"").concat(c(n)),invalidText:null===(t=i[n.uuid])||void 0===t?void 0:t.message,invalid:!!i[n.uuid]}),a().createElement(o.ebT,{text:l("chooseAnOption","Choose an option"),value:""}),(null==n||null===(r=n.answers)||void 0===r?void 0:r.length)&&(null==n||null===(u=n.answers)||void 0===u?void 0:u.map((function(e){return a().createElement(o.ebT,{key:e.uuid,text:e.display,value:e.uuid},e.display)}))))}}),(0,m.rf)(n)&&n.setMembers.map((function(e){return a().createElement(a().Fragment,{key:e.uuid},(0,m.KH)(e)&&a().createElement(u.xI,{control:t,name:e.uuid,render:function(n){var t,r=n.field;return a().createElement(o.ksK,B(j({},r),{id:"text-".concat(e.uuid),className:T.textInput,key:e.uuid,labelText:"".concat((null==e?void 0:e.display)?e.display+" ":"").concat(c(e)),type:"text",invalidText:null===(t=i[e.uuid])||void 0===t?void 0:t.message,invalid:!!i[e.uuid]}))}}),(0,m.kf)(e)&&a().createElement(u.xI,{control:t,name:e.uuid,render:function(n){var t,r=n.field;return a().createElement(o.Q7x,{allowEmpty:!0,className:T.numberInput,disableWheel:!0,hideSteppers:!0,id:"number-".concat(e.uuid),key:e.uuid,label:"".concat((null==e?void 0:e.display)?e.display+" ":"").concat(c(e)),onChange:function(e){return r.onChange(parseFloat(e.target.value))},value:r.value||"",invalidText:null===(t=i[e.uuid])||void 0===t?void 0:t.message,invalid:!!i[e.uuid]})}}),(0,m.eY)(e)&&a().createElement(u.xI,{name:e.uuid,control:t,render:function(n){var t,r,u=n.field;return a().createElement(o.l6P,B(j({},u),{className:T.textInput,defaultValue:d(e.uuid,e.datatype.display),id:"select-".concat(e.uuid),key:e.uuid,labelText:"".concat((null==e?void 0:e.display)?e.display+" ":"").concat(c(e)),type:"text",invalidText:null===(t=i[e.uuid])||void 0===t?void 0:t.message,invalid:!!i[e.uuid]}),a().createElement(o.ebT,{text:l("chooseAnOption","Choose an option"),value:""}),null==e||null===(r=e.answers)||void 0===r?void 0:r.map((function(e){return a().createElement(o.ebT,{key:e.uuid,text:e.display,value:e.uuid},e.display)})))}}))})))};function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function L(e,n,t,r,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void t(e)}l.done?n(u):Promise.resolve(u).then(r,a)}function P(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function W(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||M(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,n){if(e){if("string"==typeof e)return I(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(e,n):void 0}}const z=function(e){var n=e.closeWorkspace,t=e.closeWorkspaceWithSavedChanges,i=e.order,g=e.promptBeforeClosing,y=e.invalidateLabOrders,v=(0,s.useTranslation)().t,A=(0,p.useAbortController)(),h="tablet"===(0,p.useLayoutType)(),C=(0,m.oi)(i.concept.uuid),$=C.concept,k=C.isLoading,w=W((0,r.useState)(!1),2),E=w[0],x=w[1],D=function(e){var n,t=(0,m.oi)(e),r=t.concept;if(t.isLoading||!r)return r||console.warn("Couldn't load concept ".concat(e)),b.z.object({});var a,o,i,l,u,s,c,d,p=null!==(n=null==r?void 0:r.setMembers)&&void 0!==n?n:[];return p.length>0?(d=p,b.z.object(d.reduce((function(e,n){return e[n.uuid]=f(n),e}),{}))):(s=(a=r).hiAbsolute,c=a.lowAbsolute,o="NM"===a.datatype.hl7Abbreviation?_(a,s,c):b.z.any(),b.z.object((i={},u=o,(l=a.uuid)in i?Object.defineProperty(i,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[l]=u,i)))}(i.concept.uuid),N=(0,m.mV)(i),O=N.completeLabResult,S=N.isLoading,j=N.mutate,B=(0,r.useCallback)((function(){(0,c.Tk)((function(e){return"string"==typeof e&&e.startsWith("".concat(p.restBaseUrl,"/order?patient=").concat(i.patient.uuid))}),void 0,{revalidate:!0})}),[i.patient.uuid]),z=(0,u.mN)({defaultValues:{},resolver:(0,d.u)(D),mode:"all"}),K=z.control,Y=z.formState,R=Y.errors,G=Y.isDirty,H=Y.isSubmitting,V=z.setValue,q=z.handleSubmit;if((0,r.useEffect)((function(){var e;$&&O&&"COMPLETED"===(null==i?void 0:i.fulfillerStatus)&&((0,m.eY)($)&&"object"==typeof(null==O?void 0:O.value)&&(null==O||null===(e=O.value)||void 0===e?void 0:e.uuid)?V($.uuid,O.value.uuid):(0,m.kf)($)&&(null==O?void 0:O.value)?V($.uuid,parseFloat(O.value)):(0,m.KH)($)&&(null==O?void 0:O.value)?V($.uuid,null==O?void 0:O.value):(0,m.rf)($)&&$.setMembers.forEach((function(e){var n,t=O.groupMembers.find((function(n){return n.concept.uuid===e.uuid}));(0,m.eY)(e)?n="object"==typeof(null==t?void 0:t.value)?t.value.uuid:null==t?void 0:t.value:(0,m.kf)(e)?n=(null==t?void 0:t.value)?parseFloat(t.value):void 0:(0,m.KH)(e)&&(n=null==t?void 0:t.value),n&&V(e.uuid,n)})))}),[$,O,i,V]),(0,r.useEffect)((function(){g((function(){return G}))}),[G,g]),k)return a().createElement("div",{className:T.loaderContainer},a().createElement(o.OuH,{className:T.loader,description:v("loadingTestDetails","Loading test details")+"...",iconDescription:v("loading","Loading"),status:"active"}));var U,Q,J,X=(U=function(e){var n,r,a,o,l,u,s,c;return function(e,n){var t,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(d){switch(d.label){case 0:return Object.values(e).every((function(e){return""===e||null==e}))?(x(!0),[2]):(n=function(e,n){(0,p.showSnackbar)({title:"success"===e?v("saveLabResults","Save lab results"):v("errorSavingLabResults","Error saving lab results"),kind:e,subtitle:n})},"COMPLETED"!==i.fulfillerStatus?[3,2]:(r=Object.entries(e).map((function(e){var n,t,r=W(e,2),a=r[0],o=r[1],i=null!==(t=null==O||null===(n=O.groupMembers)||void 0===n?void 0:n.find((function(e){return e.concept.uuid===a})))&&void 0!==t?t:O;return(0,m.OF)(null==i?void 0:i.uuid,{value:o})})),[4,Promise.allSettled(r)]));case 1:return a=d.sent(),(o=a.reduce((function(n,t,r){return"rejected"===t.status?(a=n,function(e){if(Array.isArray(e))return I(e)}(a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||M(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([Object.keys(e).at(r)]):n;var a}),[])).length?n("error","Could not save obs with concept uuids "+o.join(", ")):(t(),n("success",v("successfullySavedLabResults","Lab results for {{orderNumber}} have been successfully updated",{orderNumber:null==i?void 0:i.orderNumber}))),j(),[2,x(!1)];case 2:l=(0,m.Dd)($,i,e,"FINAL"),u={previousOrder:i.uuid,type:"testorder",action:"DISCONTINUE",careSetting:i.careSetting.uuid,encounter:i.encounter.uuid,patient:i.patient.uuid,concept:i.concept.uuid,orderer:i.orderer},s={fulfillerStatus:"COMPLETED",fulfillerComment:"Test Results Entered"},d.label=3;case 3:return d.trys.push([3,5,6,7]),[4,(0,m.X1)(i.uuid,i.encounter.uuid,l,s,u,A)];case 4:return d.sent(),t(),B(),j(),null==y||y(),n("success",v("successfullySavedLabResults","Lab results for {{orderNumber}} have been successfully updated",{orderNumber:null==i?void 0:i.orderNumber})),[3,7];case 5:return c=d.sent(),n("error",null==c?void 0:c.message),[3,7];case 6:return x(!1),[7];case 7:return[2]}}))},Q=function(){var e=this,n=arguments;return new Promise((function(t,r){var a=U.apply(e,n);function o(e){L(a,t,r,o,i,"next",e)}function i(e){L(a,t,r,o,i,"throw",e)}o(void 0)}))},function(e){return Q.apply(this,arguments)});return a().createElement(o.lVW,{className:T.form,onSubmit:q(X)},a().createElement("div",{className:T.grid},$.setMembers.length>0&&a().createElement("p",{className:T.heading},$.display),$&&a().createElement(o.BJc,{gap:5},S?a().createElement(o.OuH,{description:v("loadingInitialValues","Loading initial values")+"..."}):a().createElement(F,{defaultValue:O,concept:$,control:K,errors:R})),E&&a().createElement(o.jeF,{className:T.emptyFormError,lowContrast:!0,title:v("error","Error"),subtitle:v("pleaseFillField","Please fill at least one field")+"."})),a().createElement(o.Te$,{className:l()((J={},P(J,T.tablet,h),P(J,T.desktop,!h),J))},a().createElement(o.$nd,{className:T.button,kind:"secondary",disabled:H,onClick:n},v("discard","Discard")),a().createElement(o.$nd,{className:T.button,kind:"primary",disabled:H||Object.keys(R).length>0,type:"submit"},H?a().createElement(o.OuH,{description:v("saving","Saving")+"..."}):v("saveAndClose","Save and close"))))}}}]);